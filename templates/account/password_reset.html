{% extends "layouts/home.html" %}
{% load static %}
{% load i18n allauth account %}

{% block title_page %}
    {% trans "Password Reset" %}
{% endblock %}

{% block content %}
<div class="lubricant-login-container d-flex flex-column flex-lg-row flex-column-fluid">
    <!-- Brand Side Panel -->
    <div class="lubricant-login-brand d-flex flex-column flex-lg-row-auto w-xl-600px position-xl-relative">
        <div class="d-flex flex-column position-xl-fixed top-0 bottom-0 w-xl-600px scroll-y">
            <!-- Industrial Pattern Background -->
            <div class="d-flex flex-row-fluid flex-column text-center p-5 p-lg-10 pt-lg-20">
                <!-- Logo Section -->
                <div class="py-2 py-lg-10 mb-4">
                    <img
                        alt="{{ config.PROJECT_NAME }} Logo"
                        src="{% static 'assets/images/logos/logo.png' %}"
                        class="lubricant-logo max-h-75px"
                        height="50"
                    />
                </div>

                <!-- Brand Title -->
                <h1 class="lubricant-brand-title d-none d-lg-block fs-2qx pb-5 pb-md-8">
                    <i class="fas fa-shield-alt lubricant-icon me-3 lubricant-pulse"></i>
                    {% trans "Welcome to" %} {{ config.PROJECT_NAME }}
                </h1>

                <!-- Brand Description -->
                <div class="d-none d-lg-block">
                    <p class="lubricant-brand-subtitle fs-2 mb-4">
                        <i class="fas fa-key lubricant-icon me-2"></i>
                        {% trans "Recover access to your account securely" %}
                    </p>
                    <p class="lubricant-brand-subtitle fs-4 opacity-75">
                        {% trans "Industrial-grade security • Encrypted recovery • Protected access" %}
                    </p>
                </div>

                <!-- Mobile Brand -->
                <div class="d-lg-none text-center py-4">
                    <h2 class="lubricant-brand-title fs-1 mb-3">
                        {{ config.PROJECT_NAME }}
                    </h2>
                    <p class="lubricant-brand-subtitle fs-6">
                        {% trans "Password Recovery" %}
                    </p>
                </div>
            </div>

            <!-- Industrial Illustration -->
            <div class="d-none d-lg-block d-flex flex-row-auto justify-content-center align-items-end pb-10">
                <div class="text-center">
                    <i class="fas fa-lock lubricant-icon fa-5x opacity-50 mb-4"></i>
                    <div class="d-flex justify-content-center gap-3">
                        <i class="fas fa-shield-alt lubricant-icon fa-2x"></i>
                        <i class="fas fa-key text-warning fa-2x"></i>
                        <i class="fas fa-lock lubricant-icon fa-2x"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Reset Form Side -->
    <div class="d-flex flex-column flex-lg-row-fluid justify-content-center align-items-center py-10">
        <div class="w-100 w-lg-500px px-4 px-lg-0">
            <!-- Main Reset Form -->
            <div class="lubricant-login-form">
                <!-- Form Header -->
                <div class="text-center mb-10">
                    <!-- Mobile Logo -->
                    <div class="d-lg-none mb-6">
                        <img alt="Logo" src="{% static 'assets/images/logos/logo.png' %}" class="lubricant-logo max-h-50px" height="35" />
                    </div>

                    <h1 class="text-lubricant-primary mb-4 fs-2x fw-bold">
                        <i class="fas fa-key lubricant-icon me-3"></i>
                        {% trans "Forgot Password?" %}
                    </h1>
                    {% if user.is_authenticated %}
                        {% include "account/snippets/already_logged_in.html" %}
                    {% endif %}
                    <p class="text-lubricant-secondary fs-6 fw-semibold mb-6">
                        {% trans "Enter your email to reset your password." %}
                    </p>
                    <hr class="lubricant-divider">
                </div>

                <!-- Reset Form -->
                {% url 'account_reset_password' as reset_url %}
                <form class="form w-100" method="POST" action="{{ reset_url }}">
                    {% csrf_token %}

                    <!-- Email Field -->
                    <div class="fv-row mb-7">
                        <label class="lubricant-form-label required" for="email">
                            {% trans "Email" %}
                        </label>
                        <div class="position-relative">
                            <div class="input-group">
                                <span class="input-group-text bg-lubricant-surface border-end-0">
                                    <i class="fas fa-envelope text-lubricant-secondary"></i>
                                </span>
                                <input
                                    class="lubricant-form-control border-start-0 ps-5"
                                    id="email"
                                    type="email"
                                    placeholder="ejemplo@dominio.com"
                                    name="email"
                                    autocomplete="email"
                                    required
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="d-grid mb-4">
                        <button type="submit" class="btn btn-lg btn-primary py-4">
                            <span class="indicator-label fs-5 fw-bold">
                                <i class="fas fa-paper-plane me-3"></i>
                                {% trans "Send Reset Link" %}
                            </span>
                        </button>
                    </div>

                    <!-- Cancel/Back to Login -->
                    <div class="d-grid mb-6">
                        <a href="{% url "account_login" %}" class="btn btn-lg btn-light-primary py-4">
                            <i class="fas fa-arrow-left me-3"></i>
                            {% trans "Back to Login" %}
                        </a>
                    </div>

                    <!-- Security Notice -->
                    <div class="text-center">
                        <small class="text-lubricant-medium d-flex align-items-center justify-content-center">
                            <i class="fas fa-shield-alt me-2"></i>
                            {% trans "Secure password recovery process" %}
                        </small>
                    </div>
                </form>
            </div>

            <!-- Footer Information -->
            <div class="text-center mt-6">
                <p class="text-lubricant-medium fs-7">
                    <i class="fas fa-info-circle me-1"></i>
                    {% trans "Check your email inbox for the reset link" %}
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Loading Animation Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form');
    const submitBtn = document.querySelector('button[type="submit"]');

    form.addEventListener('submit', function() {
        submitBtn.classList.add('lubricant-loading');
        submitBtn.innerHTML = '<i class="fas fa-cog fa-spin me-2"></i>{% trans "Sending..." %}';
        submitBtn.disabled = true;
    });
});
</script>
{% endblock content %}
